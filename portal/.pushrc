# vi:syntax=python
from pushlib.modules.python import *
from pushlib.modules.jshint import *
env.clone_path = "push/projects-dart"
env.virtualenv = "dart-portal"


class TestTask(TestTask):
    def after(self, c):
        super().after(c)
        JSHintTask()


class ArchiveTask(ArchiveTask):
    def before(self, c):
        super().before(c)

        # need to remove one specific file so that we don't end up with conflicts
        c.run("rm -f {}/lib/python/dart/__init__.py".format(env.release_dir))


class DeployTask(DeployTask):
    def before(self):
        super().before()

        # remove the project before redeploying
        self.clean("{}/dart/portal".format(env.python_release_lib_dir))
